# INTELEGENT PLACER
## Постановка задачи
По поданной на вход фотографии нескольких предметов на светлой горизонтальной поверхности и многоугольнику понимать, можно ли расположить одновременно все эти предметы на плоскости так, чтобы они влезли в этот многоугольник. Предметы и горизонтальная поверхность, которые могут оказаться на фотографии, заранее известны.

### Входные\Выходные значения
*Вход:* 
Изображение в формате jpg предметов и многоугольника, расположенные на белой горизонтальной поверхности. Многоугольник нарисован черным маркером/фломастером на белом листе бумаги. Лист бумаги с многоугольником расположен всегда выше предметов на изображении.

*Выход:* 
Программа печатает в консоль **True**, если все предметы на фотографии могут поместиться в нарисованном многоугольнике, и **False**, если не все предметы могут поместиться в многоугольник или если изображение, поступившее на вход, не удовлетворяет требованиям.

## Требования
### Требования к фотографиям
+ Формат - jpg
+ Вертикальные
+ Соотношение сторон 4:3
+ Расстояние от камеры до поверхности не более 50 см
+ Отклонение направления камеры от перпендикуляра к горизонтальной поверхности не превышает 15 градусов
+ Цветные, без сжатия, фильтров или любой другой коррекции

### Требования к предметам:
+ Рассматриваются только предметы из предварительно подготовленного набора
+ Нет повторяющихся предметов на фотографии
+ Полностью помещаются в кадр
+ Не сливаются с листом бумаги/поверхностью
+ Не перекрывают друг друга
+ Не пересекаются с многоугольником
+ Могут находиться на листе бумаги с многоугольником или пересекать его

### Требования к многоугольнику:
+ Выпуклый
+ Имеет не более 6 вершин
+ Нарисован черным маркером/фломасетром на белом листе бумаги; На формат листа бумаги ограничений нет
+ Толщина линий многоугольника не меньше 1мм

### Требования к поверхности:
+ Однотонная горизонтальная поверхность белого цвета 
+ Ровная, без рельефа
+ Одна для всех фотографий

### Требования к освещению:
+ Дневное, другие источники света отсутствуют
+ Не должно создавать бликов
+ Если освещение создает тени от объектов, то они будут считаться их продолжением. При этом тени не должны быть больше 20% от исходного предмета и пересекаться с другими предметами/тенями.

## Данные
# Изображения использованных объектов
Фотографии лежат в директории [objects](objects)

# Тесты
Фотографии лежат в директории [test_cases](test_cases)

## Алгоритм решения задачи
### Алгоритм распознования предметов и многоугольника
1. Выделим маску с помощью бинаризации(threshold_otsu, к примеру) и морфологических операций.<br/>
2. Провести анализ компонент связности полученной маски для определения масок предметов и многоугольника:<br/>
    2.1. Для маски многоугольника должен преобладать белый цвет.<br/>
    2.2. Все остальные компоненты связности с достаточно большой площадью можно считать масками предметов.<br/>
3. Проверка входных данных на соответствие требованиям:<br/>
    3.1. Найдя особые точки многоугольника, можно проверить количество вершин и его выпуклость.<br/>
    3.2. С помощью сравнения особых точек найденных объектов с заранее известным множеством объектов проверим требования "Нет повторяющихся предметов на фотографии" и "Рассматриваются только предметы из предварительно подготовленного набора".<br/>

### Алгоритм размещения предметов
1. Отсортируем маски предметов по площадям, при этом маски объектов окружаем минимально возможными ограничивающими многоугольниками, тем самым сведя задачу к задаче расположения этих многоугольников в нашем многоугольнике.<br/>
2. Далее, начиная с самого большого по площади объекта, будем пытаться найти приемлемое расположение для всех объектов:<br/>
    2.1. Многоугольник разбиваем сеткой на массив пар (x, y) возможных положений объекта.<br/>
    2.2. Распологаем любую вершину объект в первой паре.<br/>
    2.3. Если для текущего положения объект удалось расположить, то переходим к следующему объекту, при этом положение объекта фиксируется в маске многоугольника. Если это был последний объект, то программа возвращает **True**.<br/>
    2.4. Если не удалось расположить объект в текущем положении, то повернем объект на 10 градусов, и попытаемся снова. Если осуществили полный поворот, то переходим к следующему возможному положению.<br/>
    2.5. Если проверили все возможные положения и объект расположить не удалось, то возвращаемся на шаг назад, и пытаемся расположить предыдущий объект другим способом.<br/>
3. Если на этом этапе программа не выдала результат, то тогда предметы разместить невозможно, поэтому программа возвращает **False**.
